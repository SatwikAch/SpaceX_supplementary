<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>B Simulation Study | Supplementary Materials for Gene Co-expression Network Estimation for Spatial Transcriptomics</title>
  <meta name="description" content="This containes all the supplementary materials for the paper named SpaceX: Gene Co-expression Network Estimation for Spatial Transcriptomics." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="B Simulation Study | Supplementary Materials for Gene Co-expression Network Estimation for Spatial Transcriptomics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This containes all the supplementary materials for the paper named SpaceX: Gene Co-expression Network Estimation for Spatial Transcriptomics." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="B Simulation Study | Supplementary Materials for Gene Co-expression Network Estimation for Spatial Transcriptomics" />
  
  <meta name="twitter:description" content="This containes all the supplementary materials for the paper named SpaceX: Gene Co-expression Network Estimation for Spatial Transcriptomics." />
  

<meta name="author" content="Satwik Acharyya, Xiang Zhou, Veera Baladandayuthapani" />


<meta name="date" content="2022-05-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="method.html"/>
<link rel="next" href="realdata.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Network Estimation in Spatial Transcriptomics</a></li>

<li class="divider"></li>
<li class="appendix"><span><b>Supplementary Materials</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="A" data-path="method.html"><a href="method.html"><i class="fa fa-check"></i><b>A</b> Methodology</a>
<ul>
<li class="chapter" data-level="A.1" data-path="method.html"><a href="method.html#spacex-model"><i class="fa fa-check"></i><b>A.1</b> SpaceX model</a></li>
<li class="chapter" data-level="A.2" data-path="method.html"><a href="method.html#poisson-mixed-model"><i class="fa fa-check"></i><b>A.2</b> Poisson Mixed Model</a></li>
<li class="chapter" data-level="A.3" data-path="method.html"><a href="method.html#multi-study-factor-model-msfa"><i class="fa fa-check"></i><b>A.3</b> Multi-Study Factor Model (MSFA)</a></li>
<li class="chapter" data-level="A.4" data-path="method.html"><a href="method.html#multiplicative-gamma-shrinkage-prior"><i class="fa fa-check"></i><b>A.4</b> Multiplicative gamma shrinkage prior</a></li>
<li class="chapter" data-level="A.5" data-path="method.html"><a href="method.html#novelty-in-methodology-and-estimation-procedure"><i class="fa fa-check"></i><b>A.5</b> Novelty in Methodology and Estimation Procedure</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="method.html"><a href="method.html#differences-from-individual-methods-pqlseq-spark-and-msfa"><i class="fa fa-check"></i><b>A.5.1</b> Differences from individual methods (PQLseq, SPARK and MSFA)</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="method.html"><a href="method.html#modifiend-version-of-the-model-for-cell-type-based-clusters"><i class="fa fa-check"></i><b>A.6</b> Modifiend version of the model for cell-type based clusters</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>B</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="B.1" data-path="simulation.html"><a href="simulation.html#induced-correlation-study"><i class="fa fa-check"></i><b>B.1</b> Induced Correlation Study</a></li>
<li class="chapter" data-level="B.2" data-path="simulation.html"><a href="simulation.html#data-generation-with-spatial-correlation"><i class="fa fa-check"></i><b>B.2</b> Data generation with spatial correlation</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="simulation.html"><a href="simulation.html#comparative-analysis-with-different-norm-measures"><i class="fa fa-check"></i><b>B.2.1</b> Comparative analysis with different norm measures</a></li>
<li class="chapter" data-level="B.2.2" data-path="simulation.html"><a href="simulation.html#estimation-of-latent-factors"><i class="fa fa-check"></i><b>B.2.2</b> Estimation of latent factors</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="simulation.html"><a href="simulation.html#data-generation-with-no-spatial-correlation"><i class="fa fa-check"></i><b>B.3</b> Data generation with no spatial correlation</a></li>
<li class="chapter" data-level="B.4" data-path="simulation.html"><a href="simulation.html#hub-gene-detection-based-simulation"><i class="fa fa-check"></i><b>B.4</b> Hub gene detection based simulation</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="realdata.html"><a href="realdata.html"><i class="fa fa-check"></i><b>C</b> Real Data Analysis</a>
<ul>
<li class="chapter" data-level="C.1" data-path="realdata.html"><a href="realdata.html#exploratory"><i class="fa fa-check"></i><b>C.1</b> Exploratory analysis of the datasets</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="realdata.html"><a href="realdata.html#merfish-data"><i class="fa fa-check"></i><b>C.1.1</b> Merfish Data</a></li>
<li class="chapter" data-level="C.1.2" data-path="realdata.html"><a href="realdata.html#breast-cancer-data"><i class="fa fa-check"></i><b>C.1.2</b> Breast Cancer Data</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="realdata.html"><a href="realdata.html#communitydetection"><i class="fa fa-check"></i><b>C.2</b> Community detection</a></li>
<li class="chapter" data-level="C.3" data-path="realdata.html"><a href="realdata.html#benchmarking-on-real-spatial-transcriptomics-data"><i class="fa fa-check"></i><b>C.3</b> Benchmarking on real spatial transcriptomics data</a></li>
<li class="chapter" data-level="C.4" data-path="realdata.html"><a href="realdata.html#list-of-hub-genes-and-edges"><i class="fa fa-check"></i><b>C.4</b> List of hub genes and edges</a></li>
<li class="chapter" data-level="C.5" data-path="realdata.html"><a href="realdata.html#corroboration-with-tcga-breast-cancer-data"><i class="fa fa-check"></i><b>C.5</b> Corroboration with TCGA Breast Cancer Data</a></li>
<li class="chapter" data-level="C.6" data-path="realdata.html"><a href="realdata.html#network-similarity-between-cell-type-specific-networks"><i class="fa fa-check"></i><b>C.6</b> Network similarity between cell-type specific networks</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="ImplementSpaceX.html"><a href="ImplementSpaceX.html"><i class="fa fa-check"></i><b>D</b> Implementation of SpaceX</a>
<ul>
<li class="chapter" data-level="D.1" data-path="ImplementSpaceX.html"><a href="ImplementSpaceX.html#installation"><i class="fa fa-check"></i><b>D.1</b> Installation</a></li>
<li class="chapter" data-level="D.2" data-path="ImplementSpaceX.html"><a href="ImplementSpaceX.html#data-inputs"><i class="fa fa-check"></i><b>D.2</b> Data inputs</a></li>
<li class="chapter" data-level="D.3" data-path="ImplementSpaceX.html"><a href="ImplementSpaceX.html#output"><i class="fa fa-check"></i><b>D.3</b> Output</a></li>
<li class="chapter" data-level="D.4" data-path="ImplementSpaceX.html"><a href="ImplementSpaceX.html#example"><i class="fa fa-check"></i><b>D.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supplementary Materials for Gene Co-expression Network Estimation for Spatial Transcriptomics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">B</span> Simulation Study<a href="simulation.html#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="induced-correlation-study" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">B.1</span> Induced Correlation Study<a href="simulation.html#induced-correlation-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we provide more details about the simulation study. First we consider <span class="math inline">\(3\)</span> different values of <span class="math inline">\(\rho\)</span> <span class="math inline">\((0.1,0.15,0.2)\)</span> and make a induced correlation plot by using the squared exponential spatial kernel. The plots are generented for all cell types and cell type specific cases. The vertical line denotes the value of induced correlation at the distance <span class="math inline">\(0.01\)</span>. For example the induced spatial correlations for all cell types (first Figure of <a href="#fig:induceCORR"><strong>??</strong></a>) w.r.t. <span class="math inline">\(0.01\)</span> distance are <span class="math inline">\(0.88\)</span>, <span class="math inline">\(0.80\)</span>, <span class="math inline">\(0.61\)</span> for <span class="math inline">\(\text S_{\text High}\)</span> (<span class="math inline">\(\rho = 0.2\)</span>), <span class="math inline">\(\text S_{\text Med}\)</span> (<span class="math inline">\(\rho = 0.15\)</span>), <span class="math inline">\(\text S_{\text Low}\)</span> (<span class="math inline">\(\rho = 0.1\)</span>) methods respectively.</p>
<div class="figure" style="text-align: center">
<img src="images/Merfish_induced_correlation_final.jpeg" alt="Induced correlation plot for the Merfish data" width="80%" />
<p class="caption">
(#fig:fig:induceCORR)Induced correlation plot for the Merfish data
</p>
</div>
<p><strong>Estimation of parameter <span class="math inline">\(\rho\)</span> :</strong>
We adapt the steps from the section 1.1 of supplementary information of <span class="citation">Sun, Zhu, and Zhou (<a href="#ref-sun2020statistical" role="doc-biblioref">2020</a>)</span> to estimate the length scale parameter of the spatial kernel <span class="math inline">\(\rho_{c}\)</span> based on several grid points. The estimation procedure of <span class="math inline">\(\rho_{c}\)</span> uses the pair-wise distances among spatial locations in the data to ensure scale-invariance. First the maximum <span class="math inline">\((m_{1})\)</span> and minimum <span class="math inline">\((m_{2})\)</span> value of those pairwise spatial distances are obtained. Next, equidistant <span class="math inline">\(L\)</span> points are identified in the range from <span class="math inline">\(\text{log}(m_{1}/2)\)</span> to <span class="math inline">\(\text{log}(m_{2}*2)\)</span>. In our case, we consider <span class="math inline">\(L=10\)</span> as a default value for all our simulations and spatial transcriptomics data applications. We consider the middle value of those <span class="math inline">\(10\)</span> grid points as the estimate of <span class="math inline">\(\rho_{c}\)</span>. Table <a href="simulation.html#tab:rhoest">B.1</a> shows the true and estimated values of <span class="math inline">\(\rho_{c}\)</span> which shows the grid points based estimation procedure is effective.</p>
<table>
<thead>
<tr>
<td>
True value of <span class="math inline">\(\rho_{c}\)</span>
</td>
<td>
0.2
</td>
<td>
0.15
</td>
<td>
0.1
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
Estimated value of <span class="math inline">\(\rho_{c}\)</span>
</td>
<td>
0.18
</td>
<td>
0.16
</td>
<td>
0.11
</td>
</tr>
<tr>
<td>
Standard Errors
</td>
<td>
0.11
</td>
<td>
0.13
</td>
<td>
0.14
</td>
</tr>
</tbody>
<caption style="caption-side: bottom">
<span id="tab:rhoest">Table B.1: </span> True, estimated values and standard errors of <span class="math inline">\(\rho_{c}\)</span>.
</caption>
</table>
</div>
<div id="data-generation-with-spatial-correlation" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">B.2</span> Data generation with spatial correlation<a href="simulation.html#data-generation-with-spatial-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Simulation Design</strong>: The details of the simulation design is provided in section 3 of the paper.</p>
<p><strong>Comparative Models</strong>: We discussed the <span class="math inline">\(5\)</span> comparative models in section 3 of the paper. A summary of the comparative models is provided in Table <a href="simulation.html#tab:differentmodeloverview">B.2</a></p>
<table>
<thead>
<tr>
<th>
</th>
<th>
SpaceX model
</th>
<th>
Non-spatial Poisson model
</th>
<th>
Gaussian model
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
Spatial information
</th>
<th>
<span class="math inline">\(\checkmark\)</span>
</th>
<th>
X
</th>
<th>
X
</th>
</tr>
<tr>
<th>
Poisson likelihood
</th>
<th>
<span class="math inline">\(\checkmark\)</span>
</th>
<th>
<span class="math inline">\(\checkmark\)</span>
</th>
<th>
X
</th>
</tr>
<tr>
<th>
Gaussian likelihood
</th>
<th>
X
</th>
<th>
X
</th>
<th>
<span class="math inline">\(\checkmark\)</span>
</th>
</tr>
</tbody>
<caption style="caption-side: bottom">
<span id="tab:differentmodeloverview">Table B.2: </span> Overview of comparative models.
</caption>
</table>
<p><strong>Metrics for comparison</strong>: To measure the co-expression estimation accuracy, we use the following metrics in Table <a href="simulation.html#tab:Normtable">B.3</a> such as RV coefficient <span class="citation">(<a href="#ref-robert1976unifying" role="doc-biblioref">Robert and Escoufier 1976</a>)</span> and 4 Euclidean distance based norms (<strong>Frobenius, Log-Euclidean, Root Euclidean, Riemanian</strong>, <span class="citation">Dryden et al. (<a href="#ref-dryden2009non" role="doc-biblioref">2009</a>)</span>) as defined in Table <a href="simulation.html#tab:Normtable">B.3</a>. These metrics are used to quantify the similarity between true and estimated covariance (co-expression) matrices. RV values close to <span class="math inline">\(1\)</span> (<span class="math inline">\(0\)</span>) implying higher (lower) level of similarity. For rest of the norms on Table <a href="simulation.html#tab:Normtable">B.3</a>, values closer to <span class="math inline">\(0\)</span> indicates higher level of similarity between true and estimated matrices.</p>
<table>
<thead>
<tr>
<td>
Name
</td>
<td>
<span class="math display">\[ \text{Notation} \]</span>
</td>
<td>
<span class="math display">\[ \text{Form} \]</span>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
RV
</td>
<td>
<span class="math display">\[ \text{RV}(S_{1},S_{2}) \]</span>
</td>
<td>
<span class="math display">\[\frac{ tr(  S_{1}^{T} S_{2} ) }{ \sqrt{ tr(  S_{1}^{T} S_{1} )  tr(  S_{2}^{T} S_{2} ) }  } \]</span>
</td>
</tr>
<tr>
<td>
Euclidean (Frobenius)
</td>
<td>
<span class="math display">\[ d_{E}(S_{1},S_{2}) \]</span>
</td>
<td>
<span class="math display">\[\mid \mid S_{1} - S_{2} \mid \mid \]</span>
</td>
</tr>
<tr>
<td>
Log-Euclidean
</td>
<td>
<span class="math display">\[d_{L}(S_{1},S_{2})\]</span>
</td>
<td>
<span class="math display">\[\mid \mid \log(S_{1}) - \log(S_{2}) \mid \mid \]</span>
</td>
</tr>
<tr>
<td>
Root-Euclidean
</td>
<td>
<span class="math display">\[d_{H}(S_{1},S_{2})\]</span>
</td>
<td>
<span class="math display">\[\mid \mid S_{1}^{1/2} - S_{2}^{1/2} \mid \mid \]</span>
</td>
</tr>
<tr>
<td>
Riemanian
</td>
<td>
<span class="math display">\[d_{R}(S_{1},S_{2})\]</span>
</td>
<td>
<span class="math display">\[\mid \mid S_{1}^{-1/2} S_{2} S_{1}^{-1/2} \mid \mid \]</span>
</td>
</tr>
</tbody>
<caption style="caption-side: bottom">
<span id="tab:Normtable">Table B.3: </span> Definition of different norms. Here <span class="math inline">\(\mid \mid X \mid \mid = \sqrt{\text{trace}(X^{T}X)}\)</span>.
</caption>
</table>
<div id="comparative-analysis-with-different-norm-measures" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">B.2.1</span> Comparative analysis with different norm measures<a href="simulation.html#comparative-analysis-with-different-norm-measures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- We consider the simulation setting discussed in the section 3 of the manuscript. The $5$  different methods are compared w.r.t. different norms other than **RV coefficent** [@robert1976unifying]. The **RV coefficent** between two matrices $S_{1}$ and $S_{2}$ is defined as $$\text{RV}(S_{1},S_{2}) = \frac{ tr(  S_{1}^{T} S_{2} ) }{ \sqrt{ tr(  S_{1}^{T} S_{1} )  tr(  S_{2}^{T} S_{2} ) }  }.$$ We consider 4 different norms: -->
<!-- I. **Euclidean or Frobenius**  -->
<!-- $$ -->
<!-- d_{E}(S_{1},S_{2}) = \mid \mid S_{1} - S_{2} \mid \mid,  -->
<!-- $$ -->
<!-- II. **Log-Euclidean** -->
<!-- $$ -->
<!-- d_{L}(S_{1},S_{2}) = \mid \mid \log(S_{1}) - \log(S_{2}) \mid \mid, -->
<!-- $$ -->
<!-- III. **Root Euclidean**  -->
<!-- $$ -->
<!-- d_{H}(S_{1},S_{2}) = \mid \mid S_{1}^{1/2} - S_{2}^{1/2} \mid \mid,  -->
<!-- $$ -->
<!-- IV. **Riemanian**  -->
<!-- $$ -->
<!-- d_{R}(S_{1},S_{2}) = \mid \mid S_{1}^{-1/2} S_{2} S_{1}^{-1/2} \mid \mid. -->
<!-- $$ -->
<p>Figure <a href="simulation.html#fig:AllEuclid">B.1</a> represents the boxplot of distances between true <span class="math inline">\((\Sigma_{True})\)</span> and estimated <span class="math inline">\((\Sigma_{Est})\)</span> covariance matrices where the distances are measured in <strong>Euclidean, root Euclidean, log Euclidean and Riemanian</strong> norms respectively. In all the norms we observe that spatial settings are performing better in terms of estimation than the no-spatial settings. Among the spatial settings the estimation accuracy increase with an increment in induced spatial correlation.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:AllEuclid"></span>
<img src="images/Norm_plot_rev.jpg" alt=" **Comparison of different methods based on several norms for estimation of gene co-expression in simulation study while the data is generated from a spatially correlated setting**. Boxplot of Euclidean, log-Euclidean,  root-Euclidean, Riemannian distance (Figure A, B, C and D respectively) across  $50$ replicates for $\Sigma_{\Phi} = \Phi \Phi^{T}$ and $\Sigma_{l}$ $(l = 1, \dots , L)$. We compare the norm distances for different settings for data generation with spatial correlation." width="80%" />
<p class="caption">
Figure B.1:  <strong>Comparison of different methods based on several norms for estimation of gene co-expression in simulation study while the data is generated from a spatially correlated setting</strong>. Boxplot of Euclidean, log-Euclidean, root-Euclidean, Riemannian distance (Figure A, B, C and D respectively) across <span class="math inline">\(50\)</span> replicates for <span class="math inline">\(\Sigma_{\Phi} = \Phi \Phi^{T}\)</span> and <span class="math inline">\(\Sigma_{l}\)</span> <span class="math inline">\((l = 1, \dots , L)\)</span>. We compare the norm distances for different settings for data generation with spatial correlation.
</p>
</div>
<!-- ```{r Euclid,echo=F, fig.cap="Boxplot of **Euclidean** distance $d_E(\\Sigma_{True}, \\Sigma_{Est})$ across  $50$ replicates for $\\Sigma_{\\Phi} = \\Phi \\Phi^{T}$ and $\\Sigma_{l}$ $(l = 1, \\dots , L)$. We compare the Euclidean distance for different method settings.", out.width='80%', fig.asp=0.6, fig.align='center'} -->
<!-- knitr::include_graphics("images/Distance_Euclidean_plot.jpeg") -->
<!-- ``` -->
<!-- ```{r RootEuclid,echo=F, fig.cap="Boxplot of **root Euclidean** distance $d_{H}(\\Sigma_{True}, \\Sigma_{Est})$ across  $50$ replicates for $\\Sigma_{\\Phi} = \\Phi \\Phi^{T}$ and $\\Sigma_{l}$ $(l = 1, \\dots , L)$. We compare the root Euclidean distance for different method settings.", out.width='80%', fig.asp=0.6, fig.align='center'} -->
<!-- knitr::include_graphics("images/Root_Euclidean_plot.jpeg") -->
<!-- ``` -->
<!-- ```{r LogEuclid,echo=F, fig.cap="Boxplot of **log Euclidean** distance $d_{L}( \\Sigma_{True}, \\Sigma_{Est})$ across  $50$ replicates for $\\Sigma_{\\Phi} = \\Phi \\Phi^{T}$ and $\\Sigma_{l}$ $(l = 1, \\dots , L)$. We compare the log Euclidean distance for different method settings.", out.width='80%', fig.asp=0.6, fig.align='center'} -->
<!-- knitr::include_graphics("images/Log_Euclidean_plot.jpeg") -->
<!-- ``` -->
<!-- ```{r ReiEuclid,echo=F, fig.cap="Boxplot of **Riemanian** distance $d_{R}( \\Sigma_{True}, \\Sigma_{Est})$ across  $50$ replicates for $\\Sigma_{\\Phi} = \\Phi \\Phi^{T}$ and $\\Sigma_{l}$ $(l = 1, \\dots , L)$. We compare the Riemanian distance for different method settings.", out.width='80%', fig.asp=0.6, fig.align='center'} -->
<!-- knitr::include_graphics("images/Rei_Euclidean_plot.jpeg") -->
<!-- ``` -->
</div>
<div id="estimation-of-latent-factors" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">B.2.2</span> Estimation of latent factors<a href="simulation.html#estimation-of-latent-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We follow same procedure from section 3.3 of <span class="citation">De Vito et al. (<a href="#ref-de2018bayesian" role="doc-biblioref">2021</a>)</span> to estimate shared and cluster specific number of factors i.e. <span class="math inline">\(K\)</span> and <span class="math inline">\(K_{c}\)</span> <span class="math inline">\((c=1,2, \dots C)\)</span>. Figure <a href="simulation.html#fig:factor1">B.2</a> shows shared and cluster specfic estimated factor loadings accross <span class="math inline">\(50\)</span> replicates for <span class="math inline">\(5\)</span> different methods. Figure <a href="simulation.html#fig:factor2">B.3</a> shows the median estimate of shared and cluster specfic factor loadings for <span class="math inline">\(5\)</span> different methods. From both figures one can observe that spatial settings are estimating the loadings more precisely than the non-spatial settings.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:factor1"></span>
<img src="images/Loading_Dimension_plot.jpeg" alt="Estimated dimension of factor loadings for shared and cluster specific cases accross $50$ replicates. Black solid line denotes the true dimensions." width="80%" />
<p class="caption">
Figure B.2: Estimated dimension of factor loadings for shared and cluster specific cases accross <span class="math inline">\(50\)</span> replicates. Black solid line denotes the true dimensions.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:factor2"></span>
<img src="images/Median_Loading_plot.jpeg" alt="Estimated Factor loadings with credible intervals." width="80%" />
<p class="caption">
Figure B.3: Estimated Factor loadings with credible intervals.
</p>
</div>
</div>
</div>
<div id="data-generation-with-no-spatial-correlation" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">B.3</span> Data generation with no spatial correlation<a href="simulation.html#data-generation-with-no-spatial-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Simulation design</strong>:
We consider the same simulation design, comparative models and metrics for comparison. Now, we generate the from <span class="math inline">\(\text NS_{\text P}\)</span> model where we do not consider any spatial correlation. We model the spatial parameter with a multi-variate normal distribution with mean <span class="math inline">\(0\)</span> and identity as covariance matrix. We generate the data with no spatial correlation model <span class="math inline">\(\text NS_{\text P}\)</span> and fit all the comparative models as mentioned in Table <a href="simulation.html#tab:differentmodeloverview">B.2</a>. We summarize our results based on <span class="math inline">\(50\)</span> replicated simulation study w.r.t co-expression estimation and network recovery.</p>
<p><strong>Co-expression estimation:</strong>
We display the boxplot of RV coefficients for shared (<span class="math inline">\(\bf G_{s}\)</span>) and cluster-specific (<span class="math inline">\(\bf G_{c}\)</span>, <span class="math inline">\(c=1, \dots, C\)</span>) covariance matrices in Figure <a href="simulation.html#fig:nullsimulationRVAUC">B.4</a>A across 3 comparative models in Table <a href="simulation.html#tab:differentmodeloverview">B.2</a>. Based on RV coefficients, the highest level of precision in estimation is obtained for the non-spatial setting in (IV) i.e. <span class="math inline">\(\text NS_{\text P}\)</span>. For spatial settings, we do not observe a significant loss in estimation accuracy. For example, we only loose 1.3% accuracy in estimation for spatial settings with the SpaceX method in case of the shared network. A similar inference can be drawn based on different norm measures (Euclidean, log-Euclidean, root-Euclidean, Riemannian as defined in Table <a href="simulation.html#tab:Normtable">B.3</a> as provided in Figure <a href="simulation.html#fig:nullsimulationnorm">B.5</a> (in clock-wise manner).</p>
<p><strong>Network recovery:</strong> AUC based comparisons for shared and cluster specific networks are shown in Figure <a href="simulation.html#fig:nullsimulationRVAUC">B.4</a>B. The Figure leads us to infer that no significant reduction in network recovery while comparing the spatial and non-spatial settings while data is generated without spatial correlation.</p>
<p><strong>In summary</strong>, we do not observe a significant loss in precision while applying the SpaceX model to the simulated data without any spatial correlation.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nullsimulationRVAUC"></span>
<img src="images/Null_sim_RV_ROC.jpg" alt=" **Accuracy comparison of different methodological settings in estimation and recovery of gene co-expression networks in simulation study while the data is generated without any spatial correlation. A)** The RV coefficient measures the distance between the true and estimated networks. In the left panel, we have boxplot of RV coefficients across $50$ replicates for shared and cluster-specific networks. We compare the RV coefficients for 3 different methods (I) SpaceX, (IV) $\text NS_{\text P}$ ($\rho = 0$) and (V) $\text NS_{\text G}$ (the PMM and spatial informations are not taken under consideration). **B) In the right panel**, we use AUC metric as a measure of network recovery. The Figure represents ROC curves with color-coded AUC values of networks for different settings except for $\text NS_{\text G}$ method." width="6342" />
<p class="caption">
Figure B.4:  <strong>Accuracy comparison of different methodological settings in estimation and recovery of gene co-expression networks in simulation study while the data is generated without any spatial correlation. A)</strong> The RV coefficient measures the distance between the true and estimated networks. In the left panel, we have boxplot of RV coefficients across <span class="math inline">\(50\)</span> replicates for shared and cluster-specific networks. We compare the RV coefficients for 3 different methods (I) SpaceX, (IV) <span class="math inline">\(\text NS_{\text P}\)</span> (<span class="math inline">\(\rho = 0\)</span>) and (V) <span class="math inline">\(\text NS_{\text G}\)</span> (the PMM and spatial informations are not taken under consideration). <strong>B) In the right panel</strong>, we use AUC metric as a measure of network recovery. The Figure represents ROC curves with color-coded AUC values of networks for different settings except for <span class="math inline">\(\text NS_{\text G}\)</span> method.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nullsimulationnorm"></span>
<img src="images/Null_sim_norm.jpg" alt=" **Comparison of different methods based on several norms for estimation of gene co-expression in simulation study while the data is generated without any spatial correlation**. Boxplot of Euclidean, log-Euclidean, root-Euclidean, Riemannian distances (Figure A, B, C and D respectively) across  $50$ replicates for $\Sigma_{\Phi} = \Phi \Phi^{T}$ and $\Sigma_{l}$ $(l = 1, \dots , L)$. We provide the definitions of all the norms in Table \@ref(tab:Normtable) and compare the distances for different methodological settings." width="5161" />
<p class="caption">
Figure B.5:  <strong>Comparison of different methods based on several norms for estimation of gene co-expression in simulation study while the data is generated without any spatial correlation</strong>. Boxplot of Euclidean, log-Euclidean, root-Euclidean, Riemannian distances (Figure A, B, C and D respectively) across <span class="math inline">\(50\)</span> replicates for <span class="math inline">\(\Sigma_{\Phi} = \Phi \Phi^{T}\)</span> and <span class="math inline">\(\Sigma_{l}\)</span> <span class="math inline">\((l = 1, \dots , L)\)</span>. We provide the definitions of all the norms in Table <a href="simulation.html#tab:Normtable">B.3</a> and compare the distances for different methodological settings.
</p>
</div>
<!-- \textbf{Comparison of different methods based on several norms for estimation of gene co-expression in simulation study while the data is generated without any spatial correlation}. Boxplot of Euclidean, log-Euclidean, root-Euclidean, Riemannian distances (Figure A, B, C and D respectively) across  $50$ replicates for $\Sigma_{\Phi} = \Phi \Phi^{T}$ and $\Sigma_{l}$ $(l = 1, \dots , L)$. We provide the definitions of all the norms in Table \eqref{Norm_table} and compare the distances for different methodological settings. -->
</div>
<div id="hub-gene-detection-based-simulation" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">B.4</span> Hub gene detection based simulation<a href="simulation.html#hub-gene-detection-based-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given the lack of ground truth for real data, we used a simulation study mimicking the real data structure, to evaluate the accuracy of the SpaceX method to recover true hub genes. To this end, we generate the data consisting of <span class="math inline">\(160\)</span> genes and <span class="math inline">\(5000\)</span> locations with <span class="math inline">\(7\)</span> clusters; additional design parameters and details about the simulation settings are provided in Section 3 of the paper. Next, we apply our SpaceX model to the simulated data to estimate the hub genes for each of the <span class="math inline">\(7\)</span> spatial clusters. We classify the hub gene into two categories: one with more than 40% connectivity (named “High”) and another with less than 40% connectivity (named “Low”). We choose this cut-off based on degree connectivity we found in the real data example (Section 4). Table B.4 shows the percentage of hub gene recovered for each cluster by setting <span class="math inline">\(3\)</span> different values of the spatial correlation parameter: <span class="math inline">\(\rho = 0.2, 0.15\)</span> and <span class="math inline">\(0.1\)</span> corresponding to low, medium and high levels of spatial correlation. The denominator of recovery rate is the total number of hub genes calculated from the true simulation settings whereas the numerator denotes the estimated number of hub genes obtained from the SpaceX method. From Table B.4, we observe that the percentage hub gene recovery increases with an increase as the level of spatial correlations increase <span class="math inline">\(\rho\)</span> and size of the cluster. For example, cluster 5 (size = 1700) has the following recovery rates 97.5% , 95.2%, 92.3% for highly connected hub genes corresponding to different level of spatial correlations i.e. <span class="math inline">\(\rho = 0.2,0.15\)</span> and <span class="math inline">\(0.1\)</span> respectively. The recovery rates are 97.5%, 93.2%, 90.3% for cluster 5, 4 and 1 respectively with different cluster sizes (<span class="math inline">\(N_{5}=1700\)</span>, <span class="math inline">\(N_{4}=1000\)</span>, <span class="math inline">\(N_{1}=700\)</span>). As expected, the recovery rate of the hub genes with higher connectivity is more than in the ones with low connectivity.</p>
<p><img src="images/Table_6.jpg" width="110%" style="display: block; margin: auto;" /></p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-de2018bayesian" class="csl-entry">
De Vito, Roberta, Ruggero Bellio, Lorenzo Trippa, and Giovanni Parmigiani. 2021. <span>“Bayesian Multistudy Factor Analysis for High-Throughput Biological Data.”</span> <em>The Annals of Applied Statistics</em> 15 (4): 1723–41.
</div>
<div id="ref-dryden2009non" class="csl-entry">
Dryden, Ian L, Alexey Koloydenko, Diwei Zhou, et al. 2009. <span>“Non-Euclidean Statistics for Covariance Matrices, with Applications to Diffusion Tensor Imaging.”</span> <em>The Annals of Applied Statistics</em> 3 (3): 1102–23.
</div>
<div id="ref-robert1976unifying" class="csl-entry">
Robert, Paul, and Yves Escoufier. 1976. <span>“A Unifying Tool for Linear Multivariate Statistical Methods: The RV-Coefficient.”</span> <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 25 (3): 257–65.
</div>
<div id="ref-sun2020statistical" class="csl-entry">
Sun, Shiquan, Jiaqiang Zhu, and Xiang Zhou. 2020. <span>“Statistical Analysis of Spatial Expression Patterns for Spatially Resolved Transcriptomic Studies.”</span> <em>Nature Methods</em> 17 (2): 193–200.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="method.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="realdata.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-Simulation-study.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
